<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>Minimal Test for Word - v18</title>
    
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        body { margin: 0; padding: 0; font-family: sans-serif; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        function MinimalWordTest() {
          const [comments, setComments] = useState([
            { id: "125A", text: "First comment" },
            { id: "42B", text: "Second comment" }
          ]);
          const [newId, setNewId] = useState("");
          const [deleteId, setDeleteId] = useState("");
          const [message, setMessage] = useState("Waiting for Office to load...");
          const [officeReady, setOfficeReady] = useState(false);

          useEffect(() => {
            Office.onReady((info) => {
              if (info.host === Office.HostType.Word) {
                setOfficeReady(true);
                setMessage("✓ Office is ready! Try the buttons.");
              }
            });
          }, []);

          // SIMPLE add function - NO Word.run
          function handleAdd() {
            setMessage("Add button clicked!");
            
            if (!newId.trim()) {
              setMessage("Please enter a comment ID");
              return;
            }
            
            const newComment = { id: newId, text: "New comment" };
            setComments([...comments, newComment]);
            setMessage(`✓ Added comment ${newId}`);
            setNewId("");
          }

          // SIMPLE delete function - NO Word.run
          function handleDelete() {
            setMessage("Delete button clicked!");
            
            if (!deleteId.trim()) {
              setMessage("Please enter a comment ID to delete");
              return;
            }
            
            const exists = comments.find(c => c.id === deleteId);
            if (!exists) {
              setMessage(`Comment ${deleteId} not found`);
              return;
            }
            
            setComments(comments.filter(c => c.id !== deleteId));
            setMessage(`✓ Deleted comment ${deleteId}`);
            setDeleteId("");
          }

          return (
            <div className="min-h-screen bg-gray-100 p-4">
              <div className="bg-white rounded-lg shadow-lg p-4">
                <h1 className="text-xl font-bold mb-4">Word Button Test v18</h1>
                
                {/* Status */}
                <div className={`p-3 rounded mb-4 ${officeReady ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800'}`}>
                  <strong>Status:</strong> {message}
                </div>

                {/* Add Section */}
                <div className="mb-4 p-3 bg-green-50 rounded">
                  <h2 className="font-semibold mb-2">Add Comment</h2>
                  <div className="flex gap-2">
                    <input
                      type="text"
                      value={newId}
                      onChange={(e) => setNewId(e.target.value)}
                      placeholder="Enter ID"
                      className="flex-1 px-2 py-1 border rounded"
                    />
                    <button
                      onClick={handleAdd}
                      className="bg-green-600 hover:bg-green-700 text-white px-4 py-1 rounded font-semibold"
                      style={{ cursor: 'pointer' }}
                    >
                      ADD
                    </button>
                  </div>
                </div>

                {/* Delete Section */}
                <div className="mb-4 p-3 bg-red-50 rounded">
                  <h2 className="font-semibold mb-2">Delete Comment</h2>
                  <div className="flex gap-2">
                    <input
                      type="text"
                      value={deleteId}
                      onChange={(e) => setDeleteId(e.target.value)}
                      placeholder="Enter ID"
                      className="flex-1 px-2 py-1 border rounded"
                    />
                    <button
                      onClick={handleDelete}
                      className="bg-red-600 hover:bg-red-700 text-white px-4 py-1 rounded font-semibold"
                      style={{ cursor: 'pointer' }}
                    >
                      DELETE
                    </button>
                  </div>
                </div>

                {/* Comments List */}
                <div>
                  <h2 className="font-semibold mb-2">Comments ({comments.length})</h2>
                  {comments.map(comment => (
                    <div key={comment.id} className="p-2 bg-blue-50 rounded mb-1 flex justify-between">
                      <span><strong>{comment.id}</strong> - {comment.text}</span>
                      <button
                        onClick={() => setDeleteId(comment.id)}
                        className="text-red-600 text-sm underline"
                      >
                        Select
                      </button>
                    </div>
                  ))}
                </div>

                {/* Instructions */}
                <div className="mt-4 p-3 bg-blue-50 rounded text-sm">
                  <strong>Test:</strong>
                  <ol className="list-decimal ml-4 mt-1">
                    <li>Type "99X" and click ADD</li>
                    <li>Type "125A" and click DELETE</li>
                    <li>Watch the status message change</li>
                  </ol>
                  <p className="mt-2 text-xs text-gray-600">
                    These buttons use ZERO Word API calls. Pure React state only.
                    If they don't work, Word is blocking even simple React events.
                  </p>
                </div>
              </div>
            </div>
          );
        }

        ReactDOM.render(<MinimalWordTest />, document.getElementById('root'));
    </script>
</body>
</html>
